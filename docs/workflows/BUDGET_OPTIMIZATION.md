# Echo Alchemist 任务分派预算优化指南

## 概述

本文档定义了 Echo Alchemist 项目中，如何根据任务复杂度选择合适的 Manus Agent 模型，以实现**成本效益最大化**。

## 模型选择策略

### 可用模型

| 模型 | 适用场景 | 相对成本 |
| :--- | :--- | :--- |
| `manus-1.6-lite` | 简单任务（单文件修改、依赖安装） | 低 |
| `manus-1.6` | **标准任务（大部分开发工作）** | 中等 |
| `manus-1.6-max` | 复杂任务（核心架构、复杂重构） | 高 |

### 默认策略：优先使用 `manus-1.6-lite`

**原则**：为了最大化预算节省，默认使用 `manus-1.6-lite`。仅当任务明确需要更高级的推理能力时，才升级到 `manus-1.6` 或 `manus-1.6-max`。

## 任务分类与模型映射



### 使用 `manus-1.6-lite` 的场景（默认）

*   单个文件的简单重构
*   样式调整
*   简单的 bug 修复
*   代码模块迁移（单个类或组件）
*   依赖安装和配置

**示例任务**：
*   VOI-51: 迁移 DropBall 类
*   VOI-52: 迁移 Enemy 类
*   VOI-53: 迁移 Projectile 类
*   VOI-54: 迁移 UIManager 类
*   VOI-55: 迁移剩余视觉效果类
*   VOI-60: 修复 Vite 构建错误
*   修复 CSS 样式问题
*   调整配置参数

### 使用 `manus-1.6` 的场景

*   中等复杂度的功能开发
*   需要理解业务逻辑的 bug 修复
*   集成测试框架（如果需要编写复杂测试用例）
*   涉及多个文件的重构

**示例任务**：
*   VOI-56: 添加单元测试框架（如果需要编写测试用例）
*   复杂的业务逻辑开发

### 使用 `manus-1.6-max` 的场景（谨慎使用）

*   核心架构设计或重构
*   涉及多个模块的复杂集成
*   需要深度理解项目全局上下文的任务
*   复杂的性能优化

**示例任务**：
*   VOI-50: 迁移 Game 类（游戏主循环，涉及所有模块）
*   VOI-59: 集成核心模块并移除占位符（跨模块集成）

## 实施建议

### 1. 任务评估清单

在分派任务前，使用以下清单评估任务复杂度：

- [ ] 任务是否涉及多个文件或模块？
- [ ] 任务是否需要理解复杂的业务逻辑？
- [ ] 任务是否是核心架构的一部分？
- [ ] 任务是否有明确的、可复制的解决方案？

如果前三项中有两项或以上为"是"，考虑使用 `manus-1.6-max`；否则使用 `manus-1.6`。

### 2. 更新 `dispatch_task.py` 脚本

当前脚本已更新为默认使用 `manus-1.6`。如果需要为特定任务使用不同模型，可以在调用 `dispatch_task()` 函数时传入 `agent_profile` 参数。

**示例**：

```python
# 默认使用 manus-1.6-lite
dispatch_task\(
    issue_id="VOI-60",
    issue_url="...",
    issue_title="...",
    issue_description="..."
\)# 显式指定使用 manus-1.6-max（需修改脚本支持此参数）
dispatch_task(
    issue_id="VOI-59",
    issue_url="...",
    issue_title="...",
    issue_description="...",
    agent_profile="manus-1.6-max"  # 覆盖默认值
)
```

### 3. 成本监控

定期查看 Manus API 的使用报告，评估不同模型的成本占比。如果发现某类任务的成本过高，考虑降级模型或优化任务拆分。

## 总结

通过合理选择模型，我们可以在保证任务质量的前提下，显著降低项目的 API 调用成本。**默认使用 `manus-1.6-lite`** 是当前最佳实践，仅在任务复杂度明确超出其能力范围时才升级模型。
